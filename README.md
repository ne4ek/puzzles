Я изменил структуру хранения загадок, надеюсь от моего решения не стало хуже.